import{u as B,j as t}from"./index-D3Lmqwuk.js";import{r as i}from"./vendor-Bm7FCeSL.js";import{B as j,X as z,q as V,p as Q,o as U,c as P,b as A,E as F,r as W}from"./ui-BP2t-oC-.js";import"./router-Dh4FWyMm.js";const Z=({isOpen:h,onClose:m,onQuoteRequest:p})=>{var C;const{t:e,isRTL:a,language:M}=B(),[x,y]=i.useState([]),[u,g]=i.useState(""),[d,N]=i.useState(!1),[k,T]=i.useState([]),[$,q]=i.useState({}),S=i.useRef(null),w=i.useRef(null);i.useEffect(()=>{var s;(s=S.current)==null||s.scrollIntoView({behavior:"smooth"})},[x]),i.useEffect(()=>{const s={id:"welcome",text:e("chatbot.welcome"),sender:"bot",timestamp:new Date};y([s])},[M,e]),i.useEffect(()=>{h&&w.current&&w.current.focus()},[h]),i.useEffect(()=>{const s=r=>{r.key==="Escape"&&h&&m()};if(h)return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[h,m]);const L=i.useCallback(s=>{const r=s.toLowerCase(),n=k.join(" ").toLowerCase();T(c=>[...c.slice(-4),s.toLowerCase()]);const v={greeting:["hello","hi","hey","good morning","good afternoon","good evening","salam","مرحبا","أهلا"],pricing:["price","cost","expensive","cheap","budget","affordable","سعر","تكلفة","مكلف"],products:["product","machine","vending","snack","beverage","food","equipment","منتج","ماكينة","بيع"],features:["feature","capability","function","technology","smart","cashless","analytics","ميزة","تقنية"],contact:["contact","phone","email","address","location","office","تواصل","هاتف","عنوان"],quote:["quote","estimate","proposal","request","inquiry","عرض سعر","تقدير","طلب"],support:["help","support","issue","problem","bug","error","مساعدة","دعم","مشكلة"],company:["company","about","history","team","mission","شركة","عن","فريق"],industries:["industry","sector","business","office","hospital","school","retail","قطاع","صناعة"],installation:["install","setup","delivery","shipping","installation","تركيب","توصيل"],maintenance:["maintenance","service","repair","support","warranty","صيانة","خدمة","إصلاح"],payment:["payment","cash","card","digital","online","دفع","نقدي","إلكتروني"],analytics:["analytics","data","report","statistics","tracking","تحليلات","بيانات","تقارير"]};(c=>{const o=["budget","affordable","expensive","cheap","ميزانية","رخيص","غالي"],f=["office","hospital","school","retail","restaurant","مكتب","مستشفى","مدرسة"];o.some(l=>c.includes(l))&&q(l=>({...l,budget:c})),f.some(l=>c.includes(l))&&q(l=>({...l,industry:c}))})(r);let D="default",E=0;for(const[c,o]of Object.entries(v)){const f=o.filter(l=>r.includes(l)||n.includes(l)).length;f>E&&(E=f,D=c)}return(c=>{const o=new Date;switch(c){case"greeting":return{id:Date.now().toString(),text:e("chatbot.responses.greeting"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[e("chatbot.quickQuestions.pricing"),e("chatbot.quickQuestions.products"),e("chatbot.quickQuestions.quote")]};case"pricing":return{id:Date.now().toString(),text:$.budget?e("chatbot.responses.pricingPersonalized"):e("chatbot.responses.pricing"),sender:"bot",timestamp:o,type:"action",actions:[{id:"get-quote",label:e("chatbot.actions.getQuote"),action:()=>{p&&(p(),m())},icon:P,type:"primary"},{id:"view-products",label:e("chatbot.actions.viewProducts"),action:()=>{window.location.href="/products"},icon:W,type:"secondary"}]};case"products":return{id:Date.now().toString(),text:e("chatbot.responses.products"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[e("chatbot.suggestions.snackMachines"),e("chatbot.suggestions.beverageMachines"),e("chatbot.suggestions.foodMachines"),e("chatbot.suggestions.customSolutions")]};case"contact":return{id:Date.now().toString(),text:e("chatbot.responses.contact"),sender:"bot",timestamp:o,type:"action",actions:[{id:"whatsapp",label:e("chatbot.actions.whatsapp"),action:()=>{window.open("https://wa.me/201234567890","_blank")},icon:A,type:"primary"},{id:"email",label:e("chatbot.actions.email"),action:()=>{window.location.href="mailto:info@inovara.com"},icon:F,type:"secondary"}]};case"quote":return{id:Date.now().toString(),text:e("chatbot.responses.quote"),sender:"bot",timestamp:o,type:"action",actions:[{id:"request-quote",label:e("chatbot.actions.requestQuote"),action:()=>{p&&(p(),m())},icon:P,type:"primary"}]};case"features":return{id:Date.now().toString(),text:e("chatbot.responses.features"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[e("chatbot.suggestions.cashlessPayments"),e("chatbot.suggestions.realTimeAnalytics"),e("chatbot.suggestions.remoteManagement"),e("chatbot.suggestions.customBranding")]};case"industries":return{id:Date.now().toString(),text:e("chatbot.responses.industries"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[e("chatbot.suggestions.offices"),e("chatbot.suggestions.hospitals"),e("chatbot.suggestions.schools"),e("chatbot.suggestions.retail")]};default:return{id:Date.now().toString(),text:e("chatbot.responses.default"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[e("chatbot.quickQuestions.pricing"),e("chatbot.quickQuestions.products"),e("chatbot.quickQuestions.contact"),e("chatbot.quickQuestions.quote")]}}})(D)},[k,$,e,p,m]),b=async()=>{if(!u.trim())return;const s={id:Date.now().toString(),text:u.trim(),sender:"user",timestamp:new Date,type:"text"};y(n=>[...n,s]),g(""),N(!0);const r=800+Math.random()*1200;setTimeout(()=>{const n=L(s.text);y(v=>[...v,n]),N(!1)},r)},K=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),b())},R=[e("chatbot.quickQuestions.pricing"),e("chatbot.quickQuestions.products"),e("chatbot.quickQuestions.contact"),e("chatbot.quickQuestions.quote")],I=s=>{g(s),setTimeout(()=>b(),100)};return h?t.jsxs("div",{className:`fixed inset-0 z-[60] flex items-end p-2 sm:p-4 ${a?"justify-start":"justify-end"}`,role:"dialog","aria-modal":"true","aria-labelledby":"chatbot-title","aria-describedby":"chatbot-subtitle",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300",onClick:m,"aria-label":e("common.close")}),t.jsxs("div",{className:`
        relative w-full max-w-sm sm:max-w-md lg:max-w-lg xl:max-w-md 
        h-[85vh] sm:h-[600px] max-h-[700px] min-h-[400px]
        bg-white rounded-xl sm:rounded-2xl shadow-2xl
        flex flex-col overflow-hidden transform transition-all duration-300 ease-out
        border border-gray-200/50 backdrop-blur-sm
        ${a?"rtl":"ltr"}
        animate-in slide-in-from-bottom-4 fade-in duration-300
        focus-within:ring-2 focus-within:ring-inovara-primary/20
      `,children:[t.jsxs("div",{className:`bg-gradient-to-r from-inovara-primary to-inovara-secondary p-3 sm:p-4 flex items-center ${a?"flex-row-reverse":"flex-row"} justify-between border-b border-white/10 shrink-0`,children:[t.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 min-w-0 flex-1 ${a?"flex-row-reverse":"flex-row"}`,children:[t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white/20 backdrop-blur-sm rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg shrink-0",children:t.jsx(j,{className:"w-5 h-5 sm:w-7 sm:h-7 text-white"})}),t.jsxs("div",{className:`min-w-0 flex-1 ${a?"text-right":"text-left"}`,children:[t.jsx("h3",{id:"chatbot-title",className:"text-white font-black text-lg sm:text-xl leading-tight truncate",children:e("chatbot.title")}),t.jsx("p",{id:"chatbot-subtitle",className:"text-white/90 text-xs sm:text-sm font-medium mt-0.5 sm:mt-1 truncate",children:e("chatbot.subtitle")})]})]}),t.jsx("button",{onClick:m,className:`p-2 sm:p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg sm:rounded-xl transition-all duration-300 group shrink-0 touch-manipulation focus:outline-none focus:ring-2 focus:ring-white/30 ${a?"mr-1 sm:mr-2":"ml-1 sm:ml-2"}`,"aria-label":e("common.close"),children:t.jsx(z,{className:"w-4 h-4 sm:w-5 sm:h-5 group-hover:rotate-90 transition-transform duration-300"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[x.map(s=>t.jsx("div",{className:`flex ${s.sender==="user"?a?"justify-start":"justify-end":a?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`
                flex items-start gap-2 sm:gap-3 max-w-[90%] sm:max-w-[85%]
                ${s.sender==="user",a?"flex-row-reverse":"flex-row"}
              `,children:[t.jsx("div",{className:`
                  w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center flex-shrink-0
                  ${s.sender==="user"?"bg-inovara-primary text-white":"bg-gray-100 text-gray-600"}
                `,children:s.sender==="user"?t.jsx(V,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx(j,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsxs("div",{className:"flex flex-col gap-1.5 sm:gap-2 min-w-0 flex-1",children:[t.jsxs("div",{className:`
                    px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl text-sm shadow-sm border
                    ${s.sender==="user"?"bg-gradient-to-r from-inovara-primary to-inovara-primary/90 text-white border-inovara-primary/20":"bg-white text-gray-800 border-gray-200"}
                    break-words
                  `,children:[t.jsx("p",{className:`${a?"text-right":"text-left"} leading-relaxed`,children:s.text}),t.jsx("p",{className:`
                      text-xs mt-1 opacity-70
                      ${a?"text-right":"text-left"}
                    `,children:s.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.suggestions&&s.suggestions.length>0&&t.jsx("div",{className:`flex flex-wrap gap-1.5 sm:gap-2 ${a?"justify-end":"justify-start"}`,children:s.suggestions.map((r,n)=>t.jsx("button",{onClick:()=>{g(r),setTimeout(()=>b(),100)},className:`
                            text-xs px-2.5 sm:px-3 py-1.5 sm:py-2 bg-white hover:bg-inovara-primary/5 border border-gray-200 
                            hover:border-inovara-primary/30 rounded-lg sm:rounded-xl transition-all duration-200 
                            hover:shadow-sm cursor-pointer touch-manipulation active:scale-95
                            ${a?"text-right":"text-left"}
                            break-words
                          `,children:r},n))}),s.actions&&s.actions.length>0&&t.jsx("div",{className:`flex flex-wrap gap-1.5 sm:gap-2 ${a?"justify-end":"justify-start"}`,children:s.actions.map(r=>{const n=r.icon;return t.jsxs("button",{onClick:r.action,className:`
                              flex items-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-2 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium
                              transition-all duration-200 hover:scale-105 active:scale-95 touch-manipulation
                              ${r.type==="primary"?"bg-gradient-to-r from-inovara-primary to-inovara-secondary text-white hover:shadow-lg":"bg-white border border-gray-200 text-gray-700 hover:border-inovara-primary/30 hover:bg-inovara-primary/5"}
                              ${a?"flex-row-reverse":"flex-row"}
                            `,children:[n&&t.jsx(n,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),t.jsx("span",{className:"truncate",children:r.label})]},r.id)})})]})]})},s.id)),d&&t.jsx("div",{className:`flex ${a?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`flex items-start gap-2 sm:gap-3 ${a?"flex-row-reverse":"flex-row"}`,children:[t.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center flex-shrink-0",children:t.jsx(j,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("div",{className:"bg-white text-gray-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl shadow-sm border border-gray-200",children:t.jsxs("div",{className:`flex items-center gap-1.5 sm:gap-2 ${a?"flex-row-reverse":"flex-row"}`,children:[t.jsx(Q,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 animate-spin"}),t.jsx("span",{className:`text-xs sm:text-sm ${a?"text-right":"text-left"}`,children:e("chatbot.typing")})]})})]})}),t.jsx("div",{ref:S})]}),x.length===1&&((C=x[0])==null?void 0:C.id)==="welcome"&&t.jsxs("div",{className:"px-3 sm:px-4 pb-2 shrink-0",children:[t.jsx("p",{className:`text-xs sm:text-sm text-gray-600 mb-2 sm:mb-3 font-medium ${a?"text-right":"text-left"}`,children:e("chatbot.quickQuestions.title")}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 sm:gap-2",children:R.map((s,r)=>t.jsx("button",{onClick:()=>I(s),className:`text-xs p-2.5 sm:p-3 bg-white hover:bg-inovara-primary/5 border border-gray-200 hover:border-inovara-primary/30 rounded-lg sm:rounded-xl transition-all duration-200 hover:shadow-sm touch-manipulation active:scale-95 ${a?"text-right":"text-left"} break-words`,children:s},r))})]}),t.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200/50 bg-white/95 backdrop-blur-sm shadow-lg shrink-0",children:t.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 ${a?"flex-row-reverse":"flex-row"}`,children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{ref:w,type:"text",value:u,onChange:s=>g(s.target.value),onKeyPress:K,placeholder:e("chatbot.inputPlaceholder"),className:`
                  w-full px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-200 rounded-lg sm:rounded-xl
                  focus:outline-none focus:ring-2 sm:focus:ring-4 focus:ring-inovara-primary/20 focus:border-inovara-primary
                  text-sm placeholder-gray-500 bg-white/80 backdrop-blur-sm
                  transition-all duration-200 hover:border-gray-300
                  disabled:opacity-50 disabled:cursor-not-allowed
                  ${a?"text-right":"text-left"}
                  touch-manipulation
                `,dir:a?"rtl":"ltr",disabled:d,"aria-label":e("chatbot.inputPlaceholder"),"aria-describedby":"input-help",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"}),t.jsxs("div",{id:"input-help",className:"sr-only",children:[e("chatbot.inputPlaceholder"),". ",d?e("chatbot.typing"):""]})]}),t.jsxs("button",{onClick:b,disabled:!u.trim()||d,className:`
                relative p-2.5 sm:p-3 text-white rounded-lg sm:rounded-xl transition-all duration-300 
                focus:outline-none focus:ring-2 sm:focus:ring-4 focus:ring-inovara-primary/30
                group overflow-hidden min-w-[44px] min-h-[44px] sm:min-w-[48px] sm:min-h-[48px] flex items-center justify-center
                touch-manipulation
                ${!u.trim()||d?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-inovara-primary to-inovara-secondary hover:from-inovara-primary/90 hover:to-inovara-secondary/90 hover:shadow-lg hover:scale-105 active:scale-95"}
              `,"aria-label":e("chatbot.sendMessage"),"aria-disabled":!u.trim()||d,children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent rounded-lg sm:rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx(U,{className:`w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200 ${!u.trim()||d?"":"group-hover:translate-x-0.5"}`}),d&&t.jsx(Q,{className:"absolute w-3.5 h-3.5 sm:w-4 sm:h-4 animate-spin"}),t.jsx("div",{className:"absolute inset-0 rounded-lg sm:rounded-xl border border-white/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]})})]})]}):null};export{Z as default};

import{u as e,j as t}from"./index-DOzDRJnI.js";import{r as s}from"./vendor-DD48japz.js";import{B as a,X as r,p as o,o as i,n,b as l,a as c,E as d,q as m}from"./ui-DdgLP26B.js";import"./router-DWVnhlTE.js";import"./query-CrCWkRvr.js";const u=({isOpen:u,onClose:h,onQuoteRequest:p})=>{const{t:g,isRTL:x,language:b}=e(),[f,y]=s.useState([]),[w,v]=s.useState(""),[j,N]=s.useState(!1),[k,q]=s.useState([]),[C,S]=s.useState({}),Q=s.useRef(null),D=s.useRef(null);s.useEffect(()=>{Q.current?.scrollIntoView({behavior:"smooth"})},[f]),s.useEffect(()=>{const e={id:"welcome",text:g("chatbot.welcome"),sender:"bot",timestamp:new Date};y([e])},[b,g]),s.useEffect(()=>{u&&D.current&&D.current.focus()},[u]),s.useEffect(()=>{const e=e=>{"Escape"===e.key&&u&&h()};if(u)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[u,h]);const $=s.useCallback(e=>{const t=e.toLowerCase(),s=k.join(" ").toLowerCase();q(t=>[...t.slice(-4),e.toLowerCase()]);const a={greeting:["hello","hi","hey","good morning","good afternoon","good evening","salam","مرحبا","أهلا"],pricing:["price","cost","expensive","cheap","budget","affordable","سعر","تكلفة","مكلف"],products:["product","machine","vending","snack","beverage","food","equipment","منتج","ماكينة","بيع"],features:["feature","capability","function","technology","smart","cashless","analytics","ميزة","تقنية"],contact:["contact","phone","email","address","location","office","تواصل","هاتف","عنوان"],quote:["quote","estimate","proposal","request","inquiry","عرض سعر","تقدير","طلب"],support:["help","support","issue","problem","bug","error","مساعدة","دعم","مشكلة"],company:["company","about","history","team","mission","شركة","عن","فريق"],industries:["industry","sector","business","office","hospital","school","retail","قطاع","صناعة"],installation:["install","setup","delivery","shipping","installation","تركيب","توصيل"],maintenance:["maintenance","service","repair","support","warranty","صيانة","خدمة","إصلاح"],payment:["payment","cash","card","digital","online","دفع","نقدي","إلكتروني"],analytics:["analytics","data","report","statistics","tracking","تحليلات","بيانات","تقارير"]};var r;r=t,["budget","affordable","expensive","cheap","ميزانية","رخيص","غالي"].some(e=>r.includes(e))&&S(e=>({...e,budget:r})),["office","hospital","school","retail","restaurant","مكتب","مستشفى","مدرسة"].some(e=>r.includes(e))&&S(e=>({...e,industry:r}));let o="default",i=0;for(const[n,l]of Object.entries(a)){const e=l.filter(e=>t.includes(e)||s.includes(e)).length;e>i&&(i=e,o=n)}return(e=>{const t=new Date;switch(e){case"greeting":return{id:Date.now().toString(),text:g("chatbot.responses.greeting"),sender:"bot",timestamp:t,type:"suggestion",suggestions:[g("chatbot.quickQuestions.pricing"),g("chatbot.quickQuestions.products"),g("chatbot.quickQuestions.quote")]};case"pricing":return{id:Date.now().toString(),text:C.budget?g("chatbot.responses.pricingPersonalized"):g("chatbot.responses.pricing"),sender:"bot",timestamp:t,type:"action",actions:[{id:"get-quote",label:g("chatbot.actions.getQuote"),action:()=>{p&&(p(),h())},icon:l,type:"primary"},{id:"view-products",label:g("chatbot.actions.viewProducts"),action:()=>{window.location.href="/products"},icon:m,type:"secondary"}]};case"products":return{id:Date.now().toString(),text:g("chatbot.responses.products"),sender:"bot",timestamp:t,type:"suggestion",suggestions:[g("chatbot.suggestions.snackMachines"),g("chatbot.suggestions.beverageMachines"),g("chatbot.suggestions.foodMachines"),g("chatbot.suggestions.customSolutions")]};case"contact":return{id:Date.now().toString(),text:g("chatbot.responses.contact"),sender:"bot",timestamp:t,type:"action",actions:[{id:"whatsapp",label:g("chatbot.actions.whatsapp"),action:()=>{window.open("https://wa.me/201234567890","_blank")},icon:c,type:"primary"},{id:"email",label:g("chatbot.actions.email"),action:()=>{window.location.href="mailto:info@inovara.com"},icon:d,type:"secondary"}]};case"quote":return{id:Date.now().toString(),text:g("chatbot.responses.quote"),sender:"bot",timestamp:t,type:"action",actions:[{id:"request-quote",label:g("chatbot.actions.requestQuote"),action:()=>{p&&(p(),h())},icon:l,type:"primary"}]};case"features":return{id:Date.now().toString(),text:g("chatbot.responses.features"),sender:"bot",timestamp:t,type:"suggestion",suggestions:[g("chatbot.suggestions.cashlessPayments"),g("chatbot.suggestions.realTimeAnalytics"),g("chatbot.suggestions.remoteManagement"),g("chatbot.suggestions.customBranding")]};case"industries":return{id:Date.now().toString(),text:g("chatbot.responses.industries"),sender:"bot",timestamp:t,type:"suggestion",suggestions:[g("chatbot.suggestions.offices"),g("chatbot.suggestions.hospitals"),g("chatbot.suggestions.schools"),g("chatbot.suggestions.retail")]};default:return{id:Date.now().toString(),text:g("chatbot.responses.default"),sender:"bot",timestamp:t,type:"suggestion",suggestions:[g("chatbot.quickQuestions.pricing"),g("chatbot.quickQuestions.products"),g("chatbot.quickQuestions.contact"),g("chatbot.quickQuestions.quote")]}}})(o)},[k,C,g,p,h]),E=async()=>{if(!w.trim())return;const e={id:Date.now().toString(),text:w.trim(),sender:"user",timestamp:new Date,type:"text"};y(t=>[...t,e]),v(""),N(!0);const t=800+1200*Math.random();setTimeout(()=>{const t=$(e.text);y(e=>[...e,t]),N(!1)},t)},L=[g("chatbot.quickQuestions.pricing"),g("chatbot.quickQuestions.products"),g("chatbot.quickQuestions.contact"),g("chatbot.quickQuestions.quote")];return u?t.jsxs("div",{className:"fixed inset-0 z-[60] flex items-end p-2 sm:p-4 "+(x?"justify-start":"justify-end"),role:"dialog","aria-modal":"true","aria-labelledby":"chatbot-title","aria-describedby":"chatbot-subtitle",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300",onClick:h,"aria-label":g("common.close")}),t.jsxs("div",{className:`\n        relative w-full max-w-sm sm:max-w-md lg:max-w-lg xl:max-w-md \n        h-[85vh] sm:h-[600px] max-h-[700px] min-h-[400px]\n        bg-white rounded-xl sm:rounded-2xl shadow-2xl\n        flex flex-col overflow-hidden transform transition-all duration-300 ease-out\n        border border-gray-200/50 backdrop-blur-sm\n        ${x?"rtl":"ltr"}\n        animate-in slide-in-from-bottom-4 fade-in duration-300\n        focus-within:ring-2 focus-within:ring-inovara-primary/20\n      `,children:[t.jsxs("div",{className:`bg-gradient-to-r from-inovara-primary to-inovara-secondary p-3 sm:p-4 flex items-center ${x?"flex-row-reverse":"flex-row"} justify-between border-b border-white/10 shrink-0`,children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1 "+(x?"flex-row-reverse":"flex-row"),children:[t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white/20 backdrop-blur-sm rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg shrink-0",children:t.jsx(a,{className:"w-5 h-5 sm:w-7 sm:h-7 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1 "+(x?"text-right":"text-left"),children:[t.jsx("h3",{id:"chatbot-title",className:"text-white font-black text-lg sm:text-xl leading-tight truncate",children:g("chatbot.title")}),t.jsx("p",{id:"chatbot-subtitle",className:"text-white/90 text-xs sm:text-sm font-medium mt-0.5 sm:mt-1 truncate",children:g("chatbot.subtitle")})]})]}),t.jsx("button",{onClick:h,className:"p-2 sm:p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-lg sm:rounded-xl transition-all duration-300 group shrink-0 touch-manipulation focus:outline-none focus:ring-2 focus:ring-white/30 "+(x?"mr-1 sm:mr-2":"ml-1 sm:ml-2"),"aria-label":g("common.close"),children:t.jsx(r,{className:"w-4 h-4 sm:w-5 sm:h-5 group-hover:rotate-90 transition-transform duration-300"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[f.map(e=>t.jsx("div",{className:"flex "+("user"===e.sender?x?"justify-start":"justify-end":x?"justify-end":"justify-start"),children:t.jsxs("div",{className:`\n                flex items-start gap-2 sm:gap-3 max-w-[90%] sm:max-w-[85%]\n                ${e.sender,x?"flex-row-reverse":"flex-row"}\n              `,children:[t.jsx("div",{className:`\n                  w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center flex-shrink-0\n                  ${"user"===e.sender?"bg-inovara-primary text-white":"bg-gray-100 text-gray-600"}\n                `,children:"user"===e.sender?t.jsx(o,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx(a,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsxs("div",{className:"flex flex-col gap-1.5 sm:gap-2 min-w-0 flex-1",children:[t.jsxs("div",{className:`\n                    px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl text-sm shadow-sm border\n                    ${"user"===e.sender?"bg-gradient-to-r from-inovara-primary to-inovara-primary/90 text-white border-inovara-primary/20":"bg-white text-gray-800 border-gray-200"}\n                    break-words\n                  `,children:[t.jsx("p",{className:(x?"text-right":"text-left")+" leading-relaxed",children:e.text}),t.jsx("p",{className:`\n                      text-xs mt-1 opacity-70\n                      ${x?"text-right":"text-left"}\n                    `,children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.suggestions&&e.suggestions.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 "+(x?"justify-end":"justify-start"),children:e.suggestions.map((e,s)=>t.jsx("button",{onClick:()=>{v(e),setTimeout(()=>E(),100)},className:`\n                            text-xs px-2.5 sm:px-3 py-1.5 sm:py-2 bg-white hover:bg-inovara-primary/5 border border-gray-200 \n                            hover:border-inovara-primary/30 rounded-lg sm:rounded-xl transition-all duration-200 \n                            hover:shadow-sm cursor-pointer touch-manipulation active:scale-95\n                            ${x?"text-right":"text-left"}\n                            break-words\n                          `,children:e},s))}),e.actions&&e.actions.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 "+(x?"justify-end":"justify-start"),children:e.actions.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:e.action,className:`\n                              flex items-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-2 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium\n                              transition-all duration-200 hover:scale-105 active:scale-95 touch-manipulation\n                              ${"primary"===e.type?"bg-gradient-to-r from-inovara-primary to-inovara-secondary text-white hover:shadow-lg":"bg-white border border-gray-200 text-gray-700 hover:border-inovara-primary/30 hover:bg-inovara-primary/5"}\n                              ${x?"flex-row-reverse":"flex-row"}\n                            `,children:[s&&t.jsx(s,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),t.jsx("span",{className:"truncate",children:e.label})]},e.id)})})]})]})},e.id)),j&&t.jsx("div",{className:"flex "+(x?"justify-end":"justify-start"),children:t.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 "+(x?"flex-row-reverse":"flex-row"),children:[t.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center flex-shrink-0",children:t.jsx(a,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("div",{className:"bg-white text-gray-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl shadow-sm border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 "+(x?"flex-row-reverse":"flex-row"),children:[t.jsx(i,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 animate-spin"}),t.jsx("span",{className:"text-xs sm:text-sm "+(x?"text-right":"text-left"),children:g("chatbot.typing")})]})})]})}),t.jsx("div",{ref:Q})]}),1===f.length&&"welcome"===f[0]?.id&&t.jsxs("div",{className:"px-3 sm:px-4 pb-2 shrink-0",children:[t.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 sm:mb-3 font-medium "+(x?"text-right":"text-left"),children:g("chatbot.quickQuestions.title")}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 sm:gap-2",children:L.map((e,s)=>t.jsx("button",{onClick:()=>(e=>{v(e),setTimeout(()=>E(),100)})(e),className:`text-xs p-2.5 sm:p-3 bg-white hover:bg-inovara-primary/5 border border-gray-200 hover:border-inovara-primary/30 rounded-lg sm:rounded-xl transition-all duration-200 hover:shadow-sm touch-manipulation active:scale-95 ${x?"text-right":"text-left"} break-words`,children:e},s))})]}),t.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200/50 bg-white/95 backdrop-blur-sm shadow-lg shrink-0",children:t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 "+(x?"flex-row-reverse":"flex-row"),children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{ref:D,type:"text",value:w,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},placeholder:g("chatbot.inputPlaceholder"),className:`\n                  w-full px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-200 rounded-lg sm:rounded-xl\n                  focus:outline-none focus:ring-2 sm:focus:ring-4 focus:ring-inovara-primary/20 focus:border-inovara-primary\n                  text-sm placeholder-gray-500 bg-white/80 backdrop-blur-sm\n                  transition-all duration-200 hover:border-gray-300\n                  disabled:opacity-50 disabled:cursor-not-allowed\n                  ${x?"text-right":"text-left"}\n                  touch-manipulation\n                `,dir:x?"rtl":"ltr",disabled:j,"aria-label":g("chatbot.inputPlaceholder"),"aria-describedby":"input-help",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"}),t.jsxs("div",{id:"input-help",className:"sr-only",children:[g("chatbot.inputPlaceholder"),". ",j?g("chatbot.typing"):""]})]}),t.jsxs("button",{onClick:E,disabled:!w.trim()||j,className:`\n                relative p-2.5 sm:p-3 text-white rounded-lg sm:rounded-xl transition-all duration-300 \n                focus:outline-none focus:ring-2 sm:focus:ring-4 focus:ring-inovara-primary/30\n                group overflow-hidden min-w-[44px] min-h-[44px] sm:min-w-[48px] sm:min-h-[48px] flex items-center justify-center\n                touch-manipulation\n                ${!w.trim()||j?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-inovara-primary to-inovara-secondary hover:from-inovara-primary/90 hover:to-inovara-secondary/90 hover:shadow-lg hover:scale-105 active:scale-95"}\n              `,"aria-label":g("chatbot.sendMessage"),"aria-disabled":!w.trim()||j,children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent rounded-lg sm:rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx(n,{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200 "+(!w.trim()||j?"":"group-hover:translate-x-0.5")}),j&&t.jsx(i,{className:"absolute w-3.5 h-3.5 sm:w-4 sm:h-4 animate-spin"}),t.jsx("div",{className:"absolute inset-0 rounded-lg sm:rounded-xl border border-white/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]})})]})]}):null};export{u as default};

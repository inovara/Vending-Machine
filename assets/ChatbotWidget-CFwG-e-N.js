import{u as B,j as e}from"./index-BI4JRY58.js";import{r as i}from"./vendor-Bm7FCeSL.js";import{B as j,X as U,U as V,m as M,l as z,c as P,b as A,E as F,n as W}from"./ui-DgiCHxtl.js";import"./router-Dh4FWyMm.js";const Z=({isOpen:f,onClose:h,onQuoteRequest:p})=>{var C;const{t,isRTL:r,language:T}=B(),[x,y]=i.useState([]),[d,g]=i.useState(""),[u,N]=i.useState(!1),[k,E]=i.useState([]),[$,q]=i.useState({}),S=i.useRef(null),w=i.useRef(null);i.useEffect(()=>{var s;(s=S.current)==null||s.scrollIntoView({behavior:"smooth"})},[x]),i.useEffect(()=>{const s={id:"welcome",text:t("chatbot.welcome"),sender:"bot",timestamp:new Date};y([s])},[T,t]),i.useEffect(()=>{f&&w.current&&w.current.focus()},[f]);const L=i.useCallback(s=>{const a=s.toLowerCase(),n=k.join(" ").toLowerCase();E(c=>[...c.slice(-4),s.toLowerCase()]);const v={greeting:["hello","hi","hey","good morning","good afternoon","good evening","salam","مرحبا","أهلا"],pricing:["price","cost","expensive","cheap","budget","affordable","سعر","تكلفة","مكلف"],products:["product","machine","vending","snack","beverage","food","equipment","منتج","ماكينة","بيع"],features:["feature","capability","function","technology","smart","cashless","analytics","ميزة","تقنية"],contact:["contact","phone","email","address","location","office","تواصل","هاتف","عنوان"],quote:["quote","estimate","proposal","request","inquiry","عرض سعر","تقدير","طلب"],support:["help","support","issue","problem","bug","error","مساعدة","دعم","مشكلة"],company:["company","about","history","team","mission","شركة","عن","فريق"],industries:["industry","sector","business","office","hospital","school","retail","قطاع","صناعة"],installation:["install","setup","delivery","shipping","installation","تركيب","توصيل"],maintenance:["maintenance","service","repair","support","warranty","صيانة","خدمة","إصلاح"],payment:["payment","cash","card","digital","online","دفع","نقدي","إلكتروني"],analytics:["analytics","data","report","statistics","tracking","تحليلات","بيانات","تقارير"]};(c=>{const o=["budget","affordable","expensive","cheap","ميزانية","رخيص","غالي"],b=["office","hospital","school","retail","restaurant","مكتب","مستشفى","مدرسة"];o.some(l=>c.includes(l))&&q(l=>({...l,budget:c})),b.some(l=>c.includes(l))&&q(l=>({...l,industry:c}))})(a);let D="default",Q=0;for(const[c,o]of Object.entries(v)){const b=o.filter(l=>a.includes(l)||n.includes(l)).length;b>Q&&(Q=b,D=c)}return(c=>{const o=new Date;switch(c){case"greeting":return{id:Date.now().toString(),text:t("chatbot.responses.greeting"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[t("chatbot.quickQuestions.pricing"),t("chatbot.quickQuestions.products"),t("chatbot.quickQuestions.quote")]};case"pricing":return{id:Date.now().toString(),text:$.budget?t("chatbot.responses.pricingPersonalized"):t("chatbot.responses.pricing"),sender:"bot",timestamp:o,type:"action",actions:[{id:"get-quote",label:t("chatbot.actions.getQuote"),action:()=>{p&&(p(),h())},icon:P,type:"primary"},{id:"view-products",label:t("chatbot.actions.viewProducts"),action:()=>{window.location.href="/products"},icon:W,type:"secondary"}]};case"products":return{id:Date.now().toString(),text:t("chatbot.responses.products"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[t("chatbot.suggestions.snackMachines"),t("chatbot.suggestions.beverageMachines"),t("chatbot.suggestions.foodMachines"),t("chatbot.suggestions.customSolutions")]};case"contact":return{id:Date.now().toString(),text:t("chatbot.responses.contact"),sender:"bot",timestamp:o,type:"action",actions:[{id:"whatsapp",label:t("chatbot.actions.whatsapp"),action:()=>{window.open("https://wa.me/201234567890","_blank")},icon:A,type:"primary"},{id:"email",label:t("chatbot.actions.email"),action:()=>{window.location.href="mailto:info@inovara.com"},icon:F,type:"secondary"}]};case"quote":return{id:Date.now().toString(),text:t("chatbot.responses.quote"),sender:"bot",timestamp:o,type:"action",actions:[{id:"request-quote",label:t("chatbot.actions.requestQuote"),action:()=>{p&&(p(),h())},icon:P,type:"primary"}]};case"features":return{id:Date.now().toString(),text:t("chatbot.responses.features"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[t("chatbot.suggestions.cashlessPayments"),t("chatbot.suggestions.realTimeAnalytics"),t("chatbot.suggestions.remoteManagement"),t("chatbot.suggestions.customBranding")]};case"industries":return{id:Date.now().toString(),text:t("chatbot.responses.industries"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[t("chatbot.suggestions.offices"),t("chatbot.suggestions.hospitals"),t("chatbot.suggestions.schools"),t("chatbot.suggestions.retail")]};default:return{id:Date.now().toString(),text:t("chatbot.responses.default"),sender:"bot",timestamp:o,type:"suggestion",suggestions:[t("chatbot.quickQuestions.pricing"),t("chatbot.quickQuestions.products"),t("chatbot.quickQuestions.contact"),t("chatbot.quickQuestions.quote")]}}})(D)},[k,$,t,p,h]),m=async()=>{if(!d.trim())return;const s={id:Date.now().toString(),text:d.trim(),sender:"user",timestamp:new Date,type:"text"};y(n=>[...n,s]),g(""),N(!0);const a=800+Math.random()*1200;setTimeout(()=>{const n=L(s.text);y(v=>[...v,n]),N(!1)},a)},R=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),m())},I=[t("chatbot.quickQuestions.pricing"),t("chatbot.quickQuestions.products"),t("chatbot.quickQuestions.contact"),t("chatbot.quickQuestions.quote")],K=s=>{g(s),setTimeout(()=>m(),100)};return f?e.jsxs("div",{className:`fixed inset-0 z-[60] flex items-end p-4 ${r?"justify-start":"justify-end"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:h}),e.jsxs("div",{className:`
        relative w-full max-w-md h-[600px] bg-white rounded-2xl shadow-2xl
        flex flex-col overflow-hidden transform transition-all duration-300
        border border-gray-200/50 backdrop-blur-sm
        ${r?"rtl":"ltr"}
      `,children:[e.jsxs("div",{className:`bg-gradient-to-r from-inovara-primary to-inovara-secondary p-4 flex items-center ${r?"flex-row-reverse":"flex-row"} justify-between border-b border-white/10`,children:[e.jsxs("div",{className:`flex items-center gap-3 ${r?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(j,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{className:r?"text-right":"text-left",children:[e.jsx("h3",{className:"text-white font-black text-xl leading-tight",children:t("chatbot.title")}),e.jsx("p",{className:"text-white/90 text-sm font-medium mt-1",children:t("chatbot.subtitle")})]})]}),e.jsx("button",{onClick:h,className:`p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-300 group ${r?"mr-2":"ml-2"}`,"aria-label":t("common.close"),children:e.jsx(U,{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-300"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[x.map(s=>e.jsx("div",{className:`flex ${s.sender==="user"?r?"justify-start":"justify-end":r?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`
                flex items-start gap-3 max-w-[85%]
                ${s.sender==="user",r?"flex-row-reverse":"flex-row"}
              `,children:[e.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0
                  ${s.sender==="user"?"bg-inovara-primary text-white":"bg-gray-100 text-gray-600"}
                `,children:s.sender==="user"?e.jsx(V,{className:"w-4 h-4"}):e.jsx(j,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:`
                    px-4 py-3 rounded-2xl text-sm shadow-sm border
                    ${s.sender==="user"?"bg-gradient-to-r from-inovara-primary to-inovara-primary/90 text-white border-inovara-primary/20":"bg-white text-gray-800 border-gray-200"}
                  `,children:[e.jsx("p",{className:r?"text-right":"text-left",children:s.text}),e.jsx("p",{className:`
                      text-xs mt-1 opacity-70
                      ${r?"text-right":"text-left"}
                    `,children:s.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.suggestions&&s.suggestions.length>0&&e.jsx("div",{className:`flex flex-wrap gap-2 ${r?"justify-end":"justify-start"}`,children:s.suggestions.map((a,n)=>e.jsx("button",{onClick:()=>{g(a),setTimeout(()=>m(),100)},className:`
                            text-xs px-3 py-2 bg-white hover:bg-inovara-primary/5 border border-gray-200 
                            hover:border-inovara-primary/30 rounded-xl transition-all duration-200 
                            hover:shadow-sm cursor-pointer
                            ${r?"text-right":"text-left"}
                          `,children:a},n))}),s.actions&&s.actions.length>0&&e.jsx("div",{className:`flex flex-wrap gap-2 ${r?"justify-end":"justify-start"}`,children:s.actions.map(a=>{const n=a.icon;return e.jsxs("button",{onClick:a.action,className:`
                              flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium
                              transition-all duration-200 hover:scale-105 active:scale-95
                              ${a.type==="primary"?"bg-gradient-to-r from-inovara-primary to-inovara-secondary text-white hover:shadow-lg":"bg-white border border-gray-200 text-gray-700 hover:border-inovara-primary/30 hover:bg-inovara-primary/5"}
                              ${r?"flex-row-reverse":"flex-row"}
                            `,children:[n&&e.jsx(n,{className:"w-4 h-4"}),e.jsx("span",{children:a.label})]},a.id)})})]})]})},s.id)),u&&e.jsx("div",{className:`flex ${r?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-start gap-3 ${r?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center flex-shrink-0",children:e.jsx(j,{className:"w-4 h-4"})}),e.jsx("div",{className:"bg-white text-gray-800 px-4 py-3 rounded-2xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:`flex items-center gap-1 ${r?"flex-row-reverse":"flex-row"}`,children:[e.jsx(M,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:`text-sm ${r?"text-right":"text-left"}`,children:t("chatbot.typing")})]})})]})}),e.jsx("div",{ref:S})]}),x.length===1&&((C=x[0])==null?void 0:C.id)==="welcome"&&e.jsxs("div",{className:"px-4 pb-2",children:[e.jsx("p",{className:`text-sm text-gray-600 mb-3 font-medium ${r?"text-right":"text-left"}`,children:t("chatbot.quickQuestions.title")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:I.map((s,a)=>e.jsx("button",{onClick:()=>K(s),className:`text-xs p-3 bg-white hover:bg-inovara-primary/5 border border-gray-200 hover:border-inovara-primary/30 rounded-xl transition-all duration-200 hover:shadow-sm ${r?"text-right":"text-left"}`,children:s},a))})]}),e.jsx("div",{className:"p-4 border-t border-gray-200/50 bg-white/95 backdrop-blur-sm shadow-lg",children:e.jsxs("div",{className:`flex items-center gap-3 ${r?"flex-row-reverse":"flex-row"}`,children:[e.jsx("input",{ref:w,type:"text",value:d,onChange:s=>g(s.target.value),onKeyPress:R,placeholder:t("chatbot.inputPlaceholder"),className:`
                flex-1 px-4 py-3 border border-gray-200 rounded-xl
                focus:outline-none focus:ring-4 focus:ring-inovara-primary/20 focus:border-inovara-primary
                text-sm placeholder-gray-500 bg-white/80 backdrop-blur-sm
                transition-all duration-200 hover:border-gray-300
                disabled:opacity-50 disabled:cursor-not-allowed
                ${r?"text-right":"text-left"}
              `,disabled:u}),e.jsxs("button",{onClick:m,disabled:!d.trim()||u,className:`
                relative p-3 text-white rounded-xl transition-all duration-300 
                focus:outline-none focus:ring-4 focus:ring-inovara-primary/30
                group overflow-hidden min-w-[48px] min-h-[48px] flex items-center justify-center
                ${!d.trim()||u?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-inovara-primary to-inovara-secondary hover:from-inovara-primary/90 hover:to-inovara-secondary/90 hover:shadow-lg hover:scale-105 active:scale-95"}
              `,"aria-label":t("chatbot.sendMessage"),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx(z,{className:`w-5 h-5 transition-transform duration-200 ${!d.trim()||u?"":"group-hover:translate-x-0.5"}`}),u&&e.jsx(M,{className:"absolute w-4 h-4 animate-spin"}),e.jsx("div",{className:"absolute inset-0 rounded-xl border border-white/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]})})]})]}):null};export{Z as default};
